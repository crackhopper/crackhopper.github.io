<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>调试 on crackhopper的技术博客</title><link>https://crackhopper.github.io/tags/%E8%B0%83%E8%AF%95/</link><description>Recent content in 调试 on crackhopper的技术博客</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><managingEditor>crackhopper@gmail.com (crackhopper)</managingEditor><webMaster>crackhopper@gmail.com (crackhopper)</webMaster><lastBuildDate>Mon, 17 Nov 2025 22:05:20 +0800</lastBuildDate><atom:link href="https://crackhopper.github.io/tags/%E8%B0%83%E8%AF%95/index.xml" rel="self" type="application/rss+xml"/><item><title>WinDbg的初级用法</title><link>https://crackhopper.github.io/2025/11/17/windbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95/</link><pubDate>Mon, 17 Nov 2025 22:05:20 +0800</pubDate><author>crackhopper@gmail.com (crackhopper)</author><guid>https://crackhopper.github.io/2025/11/17/windbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95/</guid><description>&lt;p&gt;起因开始于 &lt;a class="link" href="https://crackhopper.github.io/2025/11/17/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98/" &gt;记录调试Vulkan程序打印奇怪日志的问题&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这篇文章详细展开了 WinDbg 的基础用法。&lt;/p&gt;
&lt;h1 id="正文开始"&gt;正文开始
&lt;/h1&gt;&lt;h2 id="简要介绍"&gt;简要介绍
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WinDbg&lt;/strong&gt;（Windows Debugger）是 Microsoft 提供的强大调试工具，广泛应用于 Windows 系统的内核调试、用户模式调试、崩溃转储分析等场景。它适用于调试应用程序、驱动程序、操作系统内核等各种不同类型的程序。WinDbg 支持命令行界面，并且具有图形用户界面（WinDbg Preview），它能够帮助开发人员和系统管理员诊断并修复系统崩溃或程序错误。&lt;/p&gt;
&lt;h2 id="安装与启动-windbg"&gt;安装与启动 WinDbg
&lt;/h2&gt;&lt;p&gt;参考文档： &lt;a class="link" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/" target="_blank" rel="noopener"
&gt;https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;简单来说：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-ps" data-lang="ps"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6639ba"&gt;winget&lt;/span&gt; &lt;span style="color:#6639ba"&gt;install&lt;/span&gt; &lt;span style="color:#6639ba"&gt;Microsoft.WinDbg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;用windows的包管理器下载即可。（类似苹果的HomeBrew，windows下我一般除了 winget，还会用到 chocolate 和 scoop）&lt;/p&gt;
&lt;h2 id="启动调试"&gt;启动调试
&lt;/h2&gt;&lt;p&gt;点击文件：&lt;/p&gt;
&lt;p&gt;&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763393136760.png"
loading="lazy"
alt="WinDbg的初级用法-1763393136760"
&gt;&lt;/p&gt;
&lt;p&gt;选项介绍：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Launch executable : 直接启动一个exe，并且中断到最开始的地方。&lt;/li&gt;
&lt;li&gt;Launch executable (advanced) : 这个模式支持更多设置，包括运行参数(arguments)和运行目录(start directory) 。还支持 时间旅行调试 (Time Travel Debugging, TTD)&lt;/li&gt;
&lt;li&gt;Attach to process: 附加到已经在运行的进程上进行调试。&lt;/li&gt;
&lt;li&gt;Open dump file: 加载一个先前捕获的内存转储文件（crash dump）进行事后分析。&lt;/li&gt;
&lt;li&gt;Open trace file: 加载一个先前记录的 时间旅行调试 (TTD) 跟踪文件进行回放和分析。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我们这里选择 Launch executable ，选择要调试的vulkan程序即可。&lt;/p&gt;
&lt;h2 id="时间旅行调试-ttd-time-travel-debugging"&gt;时间旅行调试 (TTD, Time Travel Debugging)
&lt;/h2&gt;&lt;p&gt;启动调试的时候，选择 &lt;code&gt;Launch executable(advanced)&lt;/code&gt; 。并勾选开启 Time Travel Debugging&lt;/p&gt;
&lt;p&gt;微软开发的一种革命性的调试技术。它允许开发者和逆向工程师&lt;strong&gt;记录&lt;/strong&gt;一个进程的执行过程，然后像观看视频一样，对这个记录进行&lt;strong&gt;回放&lt;/strong&gt;和&lt;strong&gt;反向调试&lt;/strong&gt;。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;特点&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;描述&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;优势&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;反向执行 (Reverse Execution)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;可以在程序的执行时间轴上&lt;strong&gt;向后移动&lt;/strong&gt;。&lt;/td&gt;
&lt;td&gt;能够轻松地回溯到程序状态发生损坏、或导致崩溃的那个瞬间之前，准确找出问题的根源。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;完整记录 (Full Recording)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;捕获了程序执行过程中的所有状态变化，包括 CPU 寄存器、内存读写等。&lt;/td&gt;
&lt;td&gt;无需重现 Bug。一旦记录了 Bug 发生的过程，您可以无限次地回放和分析，而 Bug 不会再“跑掉”。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;可重复性 (Reproducibility)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;调试会话基于记录文件，而不是实时运行的程序。&lt;/td&gt;
&lt;td&gt;调试过程是完全确定的，在不同的机器上、不同的时间点上分析结果始终一致，非常利于协作。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;高级查询 (Advanced Query)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;允许使用查询语言（如 Linq）来搜索整个执行历史记录。&lt;/td&gt;
&lt;td&gt;可以快速找到“是谁最后写入了这个内存地址？”或“这个函数在哪里被调用过？”等复杂问题。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;非常好用，建议调试复杂问题的时候，先开启TTD录制一次。随后加载对应的trace文件。就可以用TTD调试了。在这个调试模式可以使用：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;g-&lt;/code&gt; : 跳到上一个断点（所以把所有断点 disable 或者清空后，可以直接跳到开头）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;p-&lt;/code&gt; : 往回跳1个指令。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="常用寄存器"&gt;常用寄存器
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;变量&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;含义 (x64)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;备注&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@rcx&lt;/code&gt;, &lt;code&gt;@rdx&lt;/code&gt;, &lt;code&gt;@r8&lt;/code&gt;, &lt;code&gt;@r9&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;通用寄存器 （易失性）&lt;/td&gt;
&lt;td&gt;在windows x64下，函数调用前，这四个寄存器会保存函数调用的前4个参数。（使用的时候，可以不带 &lt;code&gt;@&lt;/code&gt; 符号)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@ip&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;instruction pointer&lt;/td&gt;
&lt;td&gt;指向下一个要执行的指令。通常配合查看汇编代码的时候。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@rsp&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;栈指针寄存器&lt;/td&gt;
&lt;td&gt;总是指向栈顶的地址。（地址越低，越靠近栈顶；函数开始调用前，会移动栈顶指针向低地址，以准备足够的栈空间用来存储局部变量）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;@r14, r15&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;通用寄存器（非易失性）&lt;/td&gt;
&lt;td&gt;常用于标识当前函数的栈帧起始位置。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ymm0, ymm1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;256位矢量寄存器&lt;/td&gt;
&lt;td&gt;avx指令集中的寄存器。AVX（Advanced Vector Extensions）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="内存的引用"&gt;内存的引用
&lt;/h2&gt;&lt;p&gt;一般采用 &lt;code&gt;[ expression ]&lt;/code&gt; 的方式引用一个内存地址。随后配合指令，决定读写的大小。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;expression&lt;/code&gt; 可以是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;寄存器&lt;/li&gt;
&lt;li&gt;寄存器 + 偏移&lt;/li&gt;
&lt;li&gt;基址 + 索引 * 缩放 + 偏移&lt;/li&gt;
&lt;li&gt;标号&lt;/li&gt;
&lt;li&gt;常量&lt;/li&gt;
&lt;li&gt;任意合法的组合&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意，有些指令需要内存对齐。否则产生GP异常（General Protection Fault，通用保护异常）。比如SSE，AVX指令。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;movaps xmm0, [rax] ; 需要 16 字节对齐，否则 #GP 异常
movdqa xmm1, [rax] ; 需要 16 字节对齐
vmovaps ymm0, [rax] ; rax 必须 32 字节对齐
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="指令集sseavx简介"&gt;指令集（SSE/AVX）简介
&lt;/h2&gt;&lt;p&gt;上一节中，提到的一些用比较特别寄存器的，都是扩展指令集的指令。这节简要介绍一些。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSE: Streaming SIMD Extensions 。Intel 在 &lt;strong&gt;1999 年&lt;/strong&gt; 发布的 SIMD（Single Instruction Multiple Data）扩展。使用 &lt;strong&gt;128 位的 XMM 寄存器（xmm0–xmm15）&lt;/strong&gt; ，提供浮点加速。通常需要对齐。&lt;/li&gt;
&lt;li&gt;AVX: Advanced Vector Extensions 。Intel 在 &lt;strong&gt;2011 年&lt;/strong&gt; 推出的 SSE 进化版。 使用 &lt;strong&gt;256 位 YMM 寄存器（ymm0–ymm15 / ymm31）&lt;/strong&gt;。具备无需对齐的指令。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;更多高阶指令：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AVX2（2013）： 整数 SIMD，Gather 指令，更强的向量整数操作（如 vpblendd、vpmulld）。&lt;/li&gt;
&lt;li&gt;AVX-512（2016）：寄存器扩大到 &lt;strong&gt;512 位的 ZMM0–31&lt;/strong&gt;。掩码寄存器（k0–k7），更丰富的数学指令（如 exp/log），分段化（Foundation / BW / VL / VNNI / IFMA 等）。应用：HPC（科学计算），AI 推理（VNNI），数据中心服务器（Xeon 里普遍支持）&lt;/li&gt;
&lt;li&gt;VNNI（Vector Neural Network Instructions）： 属于 AVX-512 家族（也有 AVX2 版本）。专为 AI 推理优化：提供更快的 dot-product（点积）运算，用于 INT8/INT16 加速。&lt;/li&gt;
&lt;li&gt;AMX（Advanced Matrix Extensions）(2021)：&lt;strong&gt;矩阵加速器&lt;/strong&gt;，不是传统 SIMD 了。Tile 寄存器（矩阵寄存器）、Tile 配置指令、Tile DP（矩阵乘加）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些跟处理器相关。通常消费级处理器，没有AMX。&lt;/p&gt;
&lt;h2 id="常用指令"&gt;常用指令
&lt;/h2&gt;&lt;h3 id="first-of-all"&gt;First of All
&lt;/h3&gt;&lt;p&gt;用 &lt;code&gt;.hh &amp;lt;x&amp;gt;&lt;/code&gt; 指令可以查看 &lt;code&gt;&amp;lt;x&amp;gt;&lt;/code&gt; 指令的文档。&lt;/p&gt;
&lt;h3 id="执行控制和断点"&gt;执行控制和断点
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;命令&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;完整形式/别名&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;功能描述&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;示例&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;g&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;go&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;继续执行&lt;/strong&gt;。程序将从当前位置继续运行直到遇到断点或退出。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;g&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;p&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;step&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;步过 (Step Over)&lt;/strong&gt;。执行下一条指令。如果下一条是函数调用，则执行完整个函数再停下。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;t&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;trace&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;步入 (Step Into)&lt;/strong&gt;。执行下一条指令。如果下一条是函数调用，则进入该函数内部并停在第一条指令。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;t&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;bp&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Set Breakpoint&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;设置软件断点&lt;/strong&gt;。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bp MyModule!MyFunction&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ba&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Set Access Breakpoint&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;设置访问断点（硬件断点）&lt;/strong&gt;。用于监视内存地址的读、写或执行。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ba w8 @rcx&lt;/code&gt; (在 &lt;code&gt;@rcx&lt;/code&gt; 地址上设置 8 字节的写访问断点)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;bl&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;List Breakpoints&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;列出&lt;/strong&gt; 当前设置的所有断点。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bl&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;bc&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Clear Breakpoints&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;清除&lt;/strong&gt; 指定编号的断点。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bc 0&lt;/code&gt; (清除编号为 0 的断点)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;be&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Enable Breakpoints&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;启用&lt;/strong&gt; 指定编号的断点。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;be 0&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;bd&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;Disable Breakpoints&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;禁用&lt;/strong&gt; 指定编号的断点。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bd 0&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;重中之重：&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;bp, ba&lt;/code&gt; : 调试必备&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意， &lt;code&gt;bl,bc,be,bd&lt;/code&gt; 在UI上操作更方便。&lt;/p&gt;
&lt;h3 id="内存检查"&gt;内存检查
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;命令&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;数据类型&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;功能描述&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;示例&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;db&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Byte (字节)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 字节数据 (1 字节/8 位)。同时显示十六进制和 ASCII 字符。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;db 0x180000000&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;dw&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Word (字)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 字数据 (2 字节/16 位)。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dw @rcx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;dd&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Double-Word (双字)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 双字数据 (4 字节/32 位)。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dd @rsp&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;dq&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Quad-Word (四字)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 四字数据 (8 字节/64 位)。&lt;strong&gt;x64 环境下最常用&lt;/strong&gt;。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dq @rcx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;da&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ASCII String&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 内存中的 &lt;strong&gt;ASCII&lt;/strong&gt; 字符串。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;da @rdx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;du&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;UNICODE String&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示&lt;/strong&gt; 内存中的 &lt;strong&gt;UNICODE&lt;/strong&gt; (UTF-16) 字符串。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;du @rcx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="上下文与符号信息-context--symbol"&gt;上下文与符号信息 (Context &amp;amp; Symbol)
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;命令&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;别名&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;功能描述&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;示例&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;r&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;registers&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;查看/修改&lt;/strong&gt; 寄存器的值。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;r&lt;/code&gt; (查看所有) 或 &lt;code&gt;r rcx=0x123&lt;/code&gt; (修改 &lt;code&gt;rcx&lt;/code&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;k&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;kb&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;显示栈回溯 (Stack Backtrace)&lt;/strong&gt;。这是最常用的调试命令之一。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;k&lt;/code&gt; 或 &lt;code&gt;kb&lt;/code&gt; (后者会显示栈上前4个QWORD)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;lm&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;list modules&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;列出&lt;/strong&gt; 当前加载的所有模块（DLL/EXE）。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;lm&lt;/code&gt; 或 &lt;code&gt;lm v&lt;/code&gt; (显示详细信息)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;x&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;examine symbols&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;检查&lt;/strong&gt; 指定模块内的符号（函数名、变量名）。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;x MyModule!*&lt;/code&gt; (列出 MyModule 的所有符号)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;?&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;evaluate&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;计算&lt;/strong&gt; 表达式的值。&lt;/td&gt;
&lt;td&gt;&lt;code&gt;? 0x10 + @r8&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;lmv m&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;查看具体模块的详细信息&lt;/td&gt;
&lt;td&gt;&lt;code&gt;lmv m vulkan_1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;用 &lt;code&gt;x&lt;/code&gt; 指令，支持通配符。可以先用来查询模块中可以使用的符号。（有些带有pdb信息的，有些无pdb信息的仍然有导出库的符号）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;r&lt;/code&gt; 指令看寄存器的时候，可以指定格式。例如 &lt;code&gt;r ymm1:uq&lt;/code&gt; 。具体参照文档。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="断点设定示例"&gt;断点设定示例
&lt;/h2&gt;&lt;p&gt;考虑在文件创建的时候打断点。&lt;/p&gt;
&lt;h3 id="createfilea-和-createfilew-函数"&gt;CreateFileA 和 CreateFileW 函数
&lt;/h3&gt;&lt;p&gt;这两个是windows的api函数，用来创建文件。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;特性&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CreateFileA (ANSI 版本)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CreateFileW (Unicode 版本)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;字符串类型&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;接受 &lt;strong&gt;ANSI/多字节&lt;/strong&gt; 字符串。&lt;/td&gt;
&lt;td&gt;接受 &lt;strong&gt;Unicode&lt;/strong&gt; (UTF-16) 字符串。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;应用场景&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;主要用于&lt;strong&gt;较老&lt;/strong&gt;或非 Unicode 环境的程序。&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;现代 Windows 应用程序的主流&lt;/strong&gt;，支持全球语言字符集。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;内部机制&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;需要在内部将 ANSI 转换为 Unicode 才能交给系统内核处理，有轻微性能开销。&lt;/td&gt;
&lt;td&gt;直接使用 Unicode，无需转换，&lt;strong&gt;效率更高，更可靠&lt;/strong&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="createfile函数参数"&gt;CreateFile函数参数
&lt;/h3&gt;&lt;p&gt;两个函数调用的参数是类似的：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;2
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;3
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;4
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;5
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;6
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;7
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;8
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-c" data-lang="c"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;HANDLE &lt;span style="color:#6639ba"&gt;CreateFileW&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; LPCWSTR lpFileName&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0550ae"&gt;//&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1.&lt;/span&gt; &lt;span style="color:#f6f8fa;background-color:#82071e"&gt;文件名&lt;/span&gt; &lt;span style="color:#1f2328"&gt;(&lt;/span&gt;W版本使用 LPCWSTR&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; DWORD dwDesiredAccess&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 2. 期望的访问权限
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwShareMode&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 3. 文件共享模式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; LPSECURITY_ATTRIBUTES lpSecurityAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 4. 安全属性
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwCreationDisposition&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;&lt;span style="color:#57606a"&gt;// 5. 创建/打开的方式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwFlagsAndAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 6. 文件属性和标志
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; HANDLE hTemplateFile &lt;span style="color:#57606a"&gt;// 7. 模板文件句柄
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;期望的访问权限：主要传入 &lt;code&gt;GENERIC_READ|GENERIC_WRITE|GENERIC_EXECUTE|0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;文件共享模式: 决定其他程序是否可以打开同一个文件。 &lt;code&gt;0|FILE_SHARED_READ|FILE_SHARED_WRITE|FILE_SHARED_DELETE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;安全属性: 主要是权限控制&lt;/li&gt;
&lt;li&gt;创建/打开的方式 : 当文件存在或者不存在的时候如何处理。&lt;strong&gt;非常关键&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CREATE_NEW&lt;/code&gt; ：创建新文件。如果文件已存在，则失败。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CREATE_ALWAYS&lt;/code&gt; ：创建新文件。如果文件已存在，则覆盖并清空。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OPEN_EXISTING&lt;/code&gt; ：打开现有文件。如果文件不存在则失败。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OPEN_ALWAYS&lt;/code&gt; ：打开现有文件。如果文件不存在则创建。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;文件属性和标志：设置隐藏文件、只读文件等等。&lt;/li&gt;
&lt;li&gt;模板文件句柄：按照模板文件来创建文件，继承其属性。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="windows-x64调用约定"&gt;Windows x64调用约定
&lt;/h3&gt;&lt;p&gt;在 Windows x64 架构下，微软规定使用 &lt;strong&gt;Fastcall&lt;/strong&gt; 调用约定，它要求函数的前四个非浮点数参数通过特定的通用寄存器传递，而不是通过栈传递。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;参数序号&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;寄存器&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;作用&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;WinDbg 伪寄存器&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;第一个参数 (Param 1)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;RCX&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;通用寄存器 C&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@rcx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;第二个参数 (Param 2)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;RDX&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;通用寄存器 D&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@rdx&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;第三个参数 (Param 3)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;R8&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;通用寄存器 R8&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@r8&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;第四个参数 (Param 4)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;R9&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;通用寄存器 R9&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;@r9&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;第五个及后续参数&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;栈 (Stack)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;从栈上获取参数&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dq @rsp + 0x28&lt;/code&gt; / &lt;code&gt;dq @rsp + 0x30&lt;/code&gt; 等&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;回顾 &lt;code&gt;CreateFileW&lt;/code&gt; 的前四个参数：&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;lpFileName&lt;/code&gt; $\rightarrow$ &lt;strong&gt;&lt;code&gt;@rcx&lt;/code&gt;&lt;/strong&gt; (文件名指针)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dwDesiredAccess&lt;/code&gt; $\rightarrow$ &lt;strong&gt;&lt;code&gt;@rdx&lt;/code&gt;&lt;/strong&gt; (访问权限 DWORD)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;dwShareMode&lt;/code&gt; $\rightarrow$ &lt;strong&gt;&lt;code&gt;@r8&lt;/code&gt;&lt;/strong&gt; (共享模式 DWORD)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lpSecurityAttributes&lt;/code&gt; $\rightarrow$ &lt;strong&gt;&lt;code&gt;@r9&lt;/code&gt;&lt;/strong&gt; (安全属性指针)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;因此，您在 WinDbg 中查看参数时，总是使用 &lt;code&gt;du @rcx&lt;/code&gt; 或 &lt;code&gt;? @rdx&lt;/code&gt; 等命令。&lt;/p&gt;
&lt;h1 id="实操演练"&gt;实操演练
&lt;/h1&gt;&lt;p&gt;我们的目标是找到异常写日志的代码。选择一个合适的方式，加载exe启动后，看到如下页面。&lt;/p&gt;
&lt;p&gt;启动对应exe：
&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763395254791.png"
loading="lazy"
alt="WinDbg的初级用法-1763395254791"
&gt;&lt;/p&gt;
&lt;h2 id="初始页面讲解"&gt;初始页面讲解
&lt;/h2&gt;&lt;h3 id="模块加载信息"&gt;模块加载信息
&lt;/h3&gt;&lt;h4 id="主程序"&gt;主程序
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;ModLoad: 00007ff7`f70b0000 00007ff7`f70fa000 image00007ff7`f70b0000
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;加载主程序。名称image后面跟着的是虚拟内存地址，意味着程序被加载到这个内存位置上。主程序永远是第一个被加载的。&lt;/p&gt;
&lt;p&gt;查看主程序模块：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; lm a 00007ff7`f70b0000
Browse full module list
start end module name
00007ff7`f70b0000 00007ff7`f70fa000 VulkanGLFWDemo C (no symbols)
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;lm&lt;/code&gt; (List Modules):&lt;/strong&gt; 基本命令，用于显示模块信息。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;a&lt;/code&gt; (Address):&lt;/strong&gt; 这是一个子命令或限定符，意思是**&amp;ldquo;按地址过滤&amp;rdquo;**。它告诉 WinDbg &lt;strong&gt;只显示包含这个特定地址的模块&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;地址用 $`$ 分隔 : 分隔内存地址的高位和低位部分是为了&lt;strong&gt;提高可读性和清晰度&lt;/strong&gt;，尤其是在处理 &lt;strong&gt;64 位 (8 字节)&lt;/strong&gt; 地址时 。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="其他模块简要介绍"&gt;其他模块简要介绍
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ntdll.dll&lt;/code&gt; : &lt;strong&gt;Windows NT 层的核心库&lt;/strong&gt;。它提供用户模式程序到内核模式驱动程序和函数的接口，是所有 Windows 进程的基石。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KERNEL32.DLL&lt;/code&gt; : 提供基本的 &lt;strong&gt;操作系统服务&lt;/strong&gt;，如内存管理、进程和线程管理、文件 I/O 等。它是 Windows 编程中最重要的 DLL 之一。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KERNELBASE.dll&lt;/code&gt; : 包含 &lt;code&gt;KERNEL32.DLL&lt;/code&gt; 的许多底层函数实现。在现代 Windows 中，许多核心 API 调用被路由到这里。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;USER32.dll&lt;/code&gt; : 负责管理用户界面元素，如&lt;strong&gt;窗口、菜单、对话框&lt;/strong&gt;等。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;win32u.dll&lt;/code&gt; : 包含底层用户模式的图形和窗口管理函数，是 &lt;code&gt;USER32.dll&lt;/code&gt; 和 &lt;code&gt;GDI32.dll&lt;/code&gt; 的&lt;strong&gt;更底层实现&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vulkan-1.dll&lt;/code&gt; : 这是一个&lt;strong&gt;图形 API 库&lt;/strong&gt;。它表明你的程序正在使用 &lt;strong&gt;Vulkan&lt;/strong&gt; 图形 API，这通常用于高性能的 3D 游戏或渲染应用。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="为什么是这个加载顺序"&gt;为什么是这个加载顺序？
&lt;/h4&gt;&lt;p&gt;任何 Windows 进程启动，都需要两个最基本的 DLL 来与内核交互和管理自身。因此，它们总是最先被加载，并且顺序非常固定：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;顺序&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;模块&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;职责和原因&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;1.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;主程序 (&lt;code&gt;VulkanGLFWDemo C&lt;/code&gt; / &lt;code&gt;image...&lt;/code&gt;)&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 它是被执行的文件。加载器首先将 EXE 文件映射到进程的虚拟地址空间，并开始解析它的导入表（Import Table）。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;2.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;ntdll.dll&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 这是所有用户模式代码访问内核服务（&lt;code&gt;ntoskrnl.exe&lt;/code&gt;）的&lt;strong&gt;唯一网关&lt;/strong&gt;。任何更高层的 DLL，包括 &lt;code&gt;KERNEL32.DLL&lt;/code&gt;，都必须通过 &lt;code&gt;ntdll.dll&lt;/code&gt; 来工作。它必须在其他所有依赖内核的模块之前加载。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;3.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;KERNEL32.DLL&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 它是提供进程、内存、文件等基本 API 的高级层。它自身依赖于 &lt;code&gt;ntdll.dll&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;4.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;KERNELBASE.dll&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 它是 &lt;code&gt;KERNEL32.DLL&lt;/code&gt; 的底层实现库。现代 Windows 将 &lt;code&gt;KERNEL32&lt;/code&gt; 的许多实际功能移到了 &lt;code&gt;KERNELBASE&lt;/code&gt; 中，以提高效率和隔离性。它紧随其后的加载，是为了满足 &lt;code&gt;KERNEL32&lt;/code&gt; 启动时的依赖。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;在基础的系统服务加载完成后，加载器会继续加载主程序&lt;strong&gt;导入表&lt;/strong&gt;中列出的下一组核心依赖项，通常是与用户界面 (UI) 相关的库：&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;顺序&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;模块&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;职责和原因&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;5.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;USER32.dll&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 主程序是一个图形应用（基于 &lt;code&gt;Vulkan&lt;/code&gt;），所以它需要窗口管理 API。&lt;code&gt;USER32.dll&lt;/code&gt; 是管理窗口、消息和对话框的关键。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;6.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;win32u.dll&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 类似 &lt;code&gt;KERNELBASE&lt;/code&gt; 和 &lt;code&gt;KERNEL32&lt;/code&gt; 的关系，&lt;code&gt;win32u.dll&lt;/code&gt; 是 &lt;code&gt;USER32.dll&lt;/code&gt; 的底层实现，用于处理用户模式和内核模式之间的用户界面切换。它在 &lt;code&gt;USER32&lt;/code&gt; 之后加载，因为它被 &lt;code&gt;USER32&lt;/code&gt; 所依赖。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;7.&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;GDI32.dll&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;原因：&lt;/strong&gt; 图形设备接口库，负责绘图、字体等。它通常是与 &lt;code&gt;USER32&lt;/code&gt; 捆绑在一起加载的，用于提供图形界面所需的基本绘制能力。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="ui配置"&gt;UI配置
&lt;/h3&gt;&lt;p&gt;页面中的View选项可以调出很多好用的窗口。根据自己的需求配置即可。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763519564490.png"
loading="lazy"
alt="WinDbg的初级用法-1763519564490"
&gt;&lt;/p&gt;
&lt;p&gt;随后可以拖拽窗口，dock到自己喜欢的位置上。&lt;/p&gt;
&lt;h3 id="第一个中断"&gt;第一个中断
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;(4d30.26a4): Break instruction exception - code 80000003 (first chance)
ntdll!LdrpDoDebuggerBreak+0x35:
00007ff8`9503f5fd cc int 3
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;进程线程信息：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;4d30&lt;/code&gt;&lt;/strong&gt;: 进程 ID (PID)，十六进制表示。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;26a4&lt;/code&gt;&lt;/strong&gt;: 线程 ID (TID)，十六进制表示。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;异常类型和状态：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Break instruction exception&lt;/code&gt;&lt;/strong&gt;: &lt;strong&gt;异常类型：&lt;/strong&gt; &lt;strong&gt;中断指令异常&lt;/strong&gt;。这意味着 CPU 遇到了一个专门用于触发调试中断的指令。&lt;/li&gt;
&lt;li&gt;code 80000003： &lt;strong&gt;异常代码：&lt;/strong&gt; 这是 Windows 中 &lt;strong&gt;硬编码断点&lt;/strong&gt;（Hardcoded Breakpoint）的异常代码。这个代码通常是由 &lt;code&gt;int 3&lt;/code&gt;（汇编指令）触发的。在 Windows 进程启动或调试器接管时，系统会故意执行这个指令，以确保调试器能在程序真正开始运行前获得控制权。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;暂停位置：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ntdll!LdrpDoDebuggerBreak+0x35&lt;/code&gt;&lt;/strong&gt;: &lt;strong&gt;模块与函数：&lt;/strong&gt; 程序当前暂停在 &lt;code&gt;ntdll.dll&lt;/code&gt; 模块中的 &lt;code&gt;LdrpDoDebuggerBreak&lt;/code&gt; 函数内，偏移量为 &lt;code&gt;+0x35&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;00007ff8`9503f5fd&lt;/code&gt; : &lt;strong&gt;内存地址：&lt;/strong&gt; 异常发生的具体指令地址。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cc&lt;/code&gt; 机器码。对应的汇编为 &lt;code&gt;int 3&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="命令窗口-0000"&gt;命令窗口 &lt;code&gt;0:000&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;p&gt;命令提示符格式: &lt;code&gt;P:T&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;P: 代表正在调试的处理器编号（CPU编号）。&lt;/li&gt;
&lt;li&gt;T: 代表正在调试的线程编号&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;命令窗口后面可以输出上面我们介绍过的调试指令。&lt;/p&gt;
&lt;h2 id="添加断点"&gt;添加断点
&lt;/h2&gt;&lt;p&gt;命令行里输入如下命令&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;bp kernel32!CreateFileA;
bp kernel32!CreateFileW;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;右下角面板可以打开 Breakpoint 选项卡：
&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763396928280.png"
loading="lazy"
alt="WinDbg的初级用法-1763396928280"
&gt;&lt;/p&gt;
&lt;p&gt;随后可以输入命令：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;g
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;启动程序运行。&lt;/p&gt;
&lt;p&gt;注意，断点另一个常见的用法是，后面接中断触发后执行的指令，比如：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;bp kernel32!CreateFileW &amp;#34;du rcx;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个断点中断后，会以 unicode字符串的方式打印 rcx指针指向的地址。这是非常常用的技巧。&lt;/p&gt;
&lt;h2 id="中断到createfile"&gt;中断到CreateFile
&lt;/h2&gt;&lt;p&gt;下面进入我们第一次中断的情况：
&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763397056640.png"
loading="lazy"
alt="WinDbg的初级用法-1763397056640"
&gt;&lt;/p&gt;
&lt;h3 id="寄存器观察"&gt;寄存器观察
&lt;/h3&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; r
rax=000000000000005c rbx=0000000000000000 rcx=00000073ac18c1b0
rdx=0000000080000000 rsi=0000022a13050f00 rdi=000000000000005c
rip=00007ff893b970f0 rsp=00000073ac18c168 rbp=00000073ac18c270
r8=0000000000000001 r9=0000000000000000 r10=0000022a13050f5c
r11=00000073ac18c1b0 r12=0000000000000000 r13=00000073ac18c310
r14=0000000000000000 r15=00000073ac18c1b0
iopl=0 nv up ei pl zr na po nc
cs=0033 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246
KERNEL32!CreateFileW:
00007ff8`93b970f0 ff25ea270300 jmp qword ptr [KERNEL32!_imp_CreateFileW (00007ff8`93bc98e0)] ds:00007ff8`93bc98e0={KERNELBASE!CreateFileW (00007ff8`922f3ac0)}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;回忆API接口：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;2
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;3
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;4
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;5
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;6
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;7
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;8
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-c" data-lang="c"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;HANDLE &lt;span style="color:#6639ba"&gt;CreateFileW&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; LPCWSTR lpFileName&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0550ae"&gt;//&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1.&lt;/span&gt; &lt;span style="color:#f6f8fa;background-color:#82071e"&gt;文件名&lt;/span&gt; &lt;span style="color:#1f2328"&gt;(&lt;/span&gt;W版本使用 LPCWSTR&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; DWORD dwDesiredAccess&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 2. 期望的访问权限
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwShareMode&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 3. 文件共享模式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; LPSECURITY_ATTRIBUTES lpSecurityAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 4. 安全属性
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwCreationDisposition&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;&lt;span style="color:#57606a"&gt;// 5. 创建/打开的方式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwFlagsAndAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 6. 文件属性和标志
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; HANDLE hTemplateFile &lt;span style="color:#57606a"&gt;// 7. 模板文件句柄
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;函数入参：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rcx&lt;/code&gt; : 第一个参数。&lt;code&gt;lpFileName&lt;/code&gt; (文件名地址)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rdx&lt;/code&gt; : 第二个参数。&lt;code&gt;dwDesiredAccess&lt;/code&gt; (期望访问权限) 。$0x80000000$ 对应 &lt;code&gt;GENERIC_READ&lt;/code&gt;。这表示程序&lt;strong&gt;只请求读取权限&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;r8&lt;/code&gt;: 第三个参数： &lt;code&gt;dwShareMode&lt;/code&gt; (共享模式)。 &lt;code&gt;0x1&lt;/code&gt; 对应 &lt;code&gt;FILE_SHARE_READ&lt;/code&gt;。这意味着其他进程在文件打开时&lt;strong&gt;可以同时拥有读取权限&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;r9&lt;/code&gt;: 第四个参数： &lt;code&gt;lpSecurityAttributes&lt;/code&gt; (安全属性) 。0代表不使用安全属性。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;函数返回：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rax&lt;/code&gt; : &lt;strong&gt;返回值寄存器&lt;/strong&gt; 。 在调用前，&lt;code&gt;RAX&lt;/code&gt; 的值不确定。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;控制/指针寄存器:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rip&lt;/code&gt; : &lt;strong&gt;Instruction Pointer (指令指针)&lt;/strong&gt;。指向当前 CPU 正在执行的下一条指令的地址，即 &lt;code&gt;KERNEL32!CreateFileW&lt;/code&gt; 的入口点。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rsp&lt;/code&gt; : &lt;strong&gt;Stack Pointer (栈指针)&lt;/strong&gt;。指向当前线程栈的顶部。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rbp&lt;/code&gt; : &lt;strong&gt;Base Pointer (基址指针)&lt;/strong&gt;。通常用于标记当前函数栈帧的底部。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="易失性和非易失性寄存器"&gt;易失性和非易失性寄存器
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rbx&lt;/code&gt; : &lt;strong&gt;非易失性（Non-Volatile）寄存器&lt;/strong&gt;，也称为&lt;strong&gt;被调用者保存（Callee-Saved）&lt;/strong&gt; 寄存器。程序员和编译器通常用 $RBX$ 来存储在整个函数执行过程中需要保持不变的 &lt;strong&gt;重要本地变量&lt;/strong&gt;或 &lt;strong&gt;指针&lt;/strong&gt; 。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rsi/rdi&lt;/code&gt; : 同上。在旧的 x86 架构中，它们传统上用作源索引（Source Index）和目标索引（Destination Index），常用于字符串和内存块操作。x64架构中，则类似 &lt;code&gt;rbx&lt;/code&gt; 。&lt;/li&gt;
&lt;li&gt;同样非易失性寄存器有： &lt;code&gt;rbx, rbp, rsi, rdi, r12, r13, r14, r15&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;而易失性寄存器有： &lt;code&gt;rcx, rdx,r8,r9 r10, r11&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="状态和段寄存器不太常用"&gt;状态和段寄存器（不太常用）
&lt;/h4&gt;&lt;p&gt;状态和段寄存器解读：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;iopl=0 nv up ei pl zr na po nc
cs=0033 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;iopl=0&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;含义：&lt;/strong&gt; &lt;strong&gt;I/O Privilege Level (I/O 特权级别)&lt;/strong&gt;。这是一个 2 位的字段，用于控制当前代码是否可以直接执行 I/O 指令。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;值：&lt;/strong&gt; $0$ 是最高的特权级别（通常是内核模式，Ring 0）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;nv &amp;hellip;.&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;含义 &lt;strong&gt;RFLAGS&lt;/strong&gt; (Registers Flags)，它包含了控制 CPU 操作和指示上次运算结果的各种标志位。&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;缩写&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;含义&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;状态&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;解释&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;nv&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Overflow Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;nv&lt;/strong&gt; (No Overflow)&lt;/td&gt;
&lt;td&gt;上一次运算没有发生溢出。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;up&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Direction Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;up&lt;/strong&gt; (Up)&lt;/td&gt;
&lt;td&gt;字符串操作（如移动数据）的方向是从低地址到高地址（递增）。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ei&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Interrupt Enable Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;ei&lt;/strong&gt; (Enable Interrupts)&lt;/td&gt;
&lt;td&gt;CPU &lt;strong&gt;允许&lt;/strong&gt;接收外部可屏蔽中断信号。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;pl&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Sign Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;pl&lt;/strong&gt; (Positive)&lt;/td&gt;
&lt;td&gt;上一次算术运算的结果是非负数（或零）。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;zr&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Zero Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;zr&lt;/strong&gt; (Zero)&lt;/td&gt;
&lt;td&gt;上一次算术或逻辑运算的结果是&lt;strong&gt;零&lt;/strong&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;na&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Auxiliary Carry Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;na&lt;/strong&gt; (Not Applicable)&lt;/td&gt;
&lt;td&gt;辅助进位标志，主要用于 BCD (Binary-Coded Decimal) 运算，通常不显示具体状态。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;po&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Parity Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;po&lt;/strong&gt; (Parity Odd)&lt;/td&gt;
&lt;td&gt;上一次运算结果的低 8 位中，置位（1）的个数是奇数。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;nc&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Carry Flag&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;nc&lt;/strong&gt; (No Carry)&lt;/td&gt;
&lt;td&gt;上一次算术运算没有产生进位或借位。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;cs=0033 &amp;hellip;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;段寄存器（Segment Registers）。x64架构中，主要用于定义&lt;strong&gt;特权级别&lt;/strong&gt;和访问一些特殊结构（如线程本地存储）。在x86架构中，段寄存器主要是辅助地址选择。&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;寄存器&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;值&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;含义&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;解释 (x64 Windows)&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;cs&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0033&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Code Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;代码段。段选择子 $0x33$ 对应于**用户模式（User Mode, Ring 3）**代码。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ss&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;002b&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Stack Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;栈段。段选择子 $0x2B$ 对应于**用户模式（User Mode, Ring 3）**数据。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ds&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;002b&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Data Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;数据段。与 SS 相同，对应于用户模式数据。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;es&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;002b&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Extra Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;附加段。与 SS/DS 相同，对应于用户模式数据。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;fs&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;0053&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;FS Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;特殊用途&lt;/strong&gt;。在 64 位 Windows 中，$FS$ 寄存器指向&lt;strong&gt;线程信息块 (TEB)&lt;/strong&gt;，用于访问线程特定的数据（如异常处理、栈限制等）。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;gs&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;002b&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;GS Segment&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;特殊用途&lt;/strong&gt;。在 64 位 Windows 中，$GS$ 寄存器通常指向 &lt;strong&gt;KPCR (内核处理器控制区)&lt;/strong&gt;，但用户模式下它的使用较少或被重定义。这里的值 $0x2B$ 可能只是一个占位符。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="更多函数参数的观察"&gt;更多函数参数的观察
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;2
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;3
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;4
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;5
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;6
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;7
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;8
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-c" data-lang="c"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;HANDLE &lt;span style="color:#6639ba"&gt;CreateFileW&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; LPCWSTR lpFileName&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0550ae"&gt;//&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1.&lt;/span&gt; &lt;span style="color:#f6f8fa;background-color:#82071e"&gt;文件名&lt;/span&gt; &lt;span style="color:#1f2328"&gt;(&lt;/span&gt;W版本使用 LPCWSTR&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; DWORD dwDesiredAccess&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 2. 期望的访问权限
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwShareMode&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 3. 文件共享模式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; LPSECURITY_ATTRIBUTES lpSecurityAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 4. 安全属性
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwCreationDisposition&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;&lt;span style="color:#57606a"&gt;// 5. 创建/打开的方式
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; DWORD dwFlagsAndAttributes&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#57606a"&gt;// 6. 文件属性和标志
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt; HANDLE hTemplateFile &lt;span style="color:#57606a"&gt;// 7. 模板文件句柄
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;lpFileName&lt;/code&gt; 下面的值显示为一个字符串。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;du @rcx
00000073`ac18c1b0 &amp;#34;C:\WINDOWS\System32\DriverStore\&amp;#34;
00000073`ac18c1f0 &amp;#34;FileRepository\nvmi.inf_amd64_c6&amp;#34;
00000073`ac18c230 &amp;#34;ae241e95feb82d\nv-vk64.json&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;ol start="2"&gt;
&lt;li&gt;&lt;code&gt;dwDesiredAccess&lt;/code&gt; : 注意，不能用 dw, db等指令，这些指令会解析参数为地址。如果是直接看寄存器的值，用r指令。下面的值显示为 &lt;code&gt;GENERIC_READ&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; r @rdx
rdx=0000000080000000
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;ol start="3"&gt;
&lt;li&gt;&lt;code&gt;dwShareMode&lt;/code&gt; ： &lt;code&gt;r @r8&lt;/code&gt; 结果为 &lt;code&gt;0x1&lt;/code&gt; 即 &lt;code&gt;FILE_SHARE_READ&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start="4"&gt;
&lt;li&gt;&lt;code&gt;lpSecurityAttributes&lt;/code&gt; ： 先用r来看地址是否为空。 &lt;code&gt;r @r9&lt;/code&gt; 。结果为0。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="关于-db-dw-dd-dq"&gt;关于 &lt;code&gt;db, dw, dd, dq&lt;/code&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;BYTE&lt;/code&gt; : 8字节 。因此， &lt;code&gt;db&lt;/code&gt; 会把内存按照8字节切分。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WORD&lt;/code&gt; : 16字节&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DWORD&lt;/code&gt; : 32字节&lt;/li&gt;
&lt;li&gt;&lt;code&gt;QWORD&lt;/code&gt; : 64字节&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="关于寄存器"&gt;关于寄存器
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;WinDbg 默认将寄存器名称视为其&lt;/strong&gt;存储的 &lt;strong&gt;值&lt;/strong&gt; 。因此比如 &lt;code&gt;dd rcx&lt;/code&gt; 实际上将rcx的值作为dd的参数。dd的参数需要使用到一个地址，因此实际会解析 rcx 存储值所指向的地址，而不是rcx的值。&lt;/p&gt;
&lt;p&gt;所以要注意： &lt;strong&gt;寄存器在 windbg 中被当作值来使用；而指令后面的参数常常作为地址来解析&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id="栈上参数"&gt;栈上参数
&lt;/h4&gt;&lt;p&gt;接着，对于5，6，7参数，都保存在栈上。对于栈上来说，约定有：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;相对地址（相对于 RSP）&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;长度 (字节)&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;含义&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;CreateFileW 参数&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x00}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;返回地址&lt;/strong&gt;（Return Address）&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&amp;mdash; 32 字节阴影空间（Shadow Space）开始 &amp;mdash;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x08}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;阴影空间槽位 1&lt;/td&gt;
&lt;td&gt;（用于保存 $\text{RCX}$ 的副本）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x10}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;阴影空间槽位 2&lt;/td&gt;
&lt;td&gt;（用于保存 $\text{RDX}$ 的副本）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x18}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;阴影空间槽位 3&lt;/td&gt;
&lt;td&gt;（用于保存 $\text{R8}$ 的副本）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x20}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;阴影空间槽位 4&lt;/td&gt;
&lt;td&gt;（用于保存 $\text{R9}$ 的副本）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;&amp;mdash; 32 字节阴影空间（Shadow Space）结束 &amp;mdash;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x28}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;第 5 个参数&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dwCreationDisposition&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x30}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;第 6 个参数&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;dwFlagsAndAttributes&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\mathbf{RSP + 0x38}$&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;第 7 个参数&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;hTemplateFile&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;阴影空间&lt;/strong&gt; : 其实是按照规范，所有参数都应该在栈上。不过windows会放入寄存器，因此这些栈上空间就相当于被留空了。（实际会保存副本）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;调用参数的存储位置&lt;/strong&gt; (正偏移): 一般在 &lt;code&gt;rsp&lt;/code&gt; 向高地址的方向去找，每次64位（即8byte）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;局部变量&lt;/strong&gt; (负偏移): 一般在 rsp 向低地址的方向去找，每次64位。所以，第一个局部变量位置在 &lt;code&gt;rsp-0x08&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start="5"&gt;
&lt;li&gt;&lt;code&gt;dwCreateionDisposition&lt;/code&gt; : dw 代表 &lt;code&gt;DWORD&lt;/code&gt; ，因此用dd指令。容易看到第一个值为 &lt;code&gt;0x03&lt;/code&gt; ，对应 &lt;code&gt;OPEN_EXISTING&lt;/code&gt; ，即打开一个文件或设备。如果文件或设备不存在，函数将失败。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; dd rsp+0x28
00000073`ac18c190 00000003 00000073 00000080 00000000
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;
&lt;ol start="6"&gt;
&lt;li&gt;&lt;code&gt;dwCreateionDisposition&lt;/code&gt; 从上一步的结果也容易看到这个参数为 &lt;code&gt;0x80&lt;/code&gt; (注意，每64bit一个参数，因此 &lt;code&gt;00000073&lt;/code&gt; 被跳过，随后是 &lt;code&gt;00000080&lt;/code&gt; ，即 &lt;code&gt;0x80&lt;/code&gt; ) ，对应值为 &lt;code&gt;FILE_ATTRIBUTE_NORMAL&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start="7"&gt;
&lt;li&gt;&lt;code&gt;hTemplateFile&lt;/code&gt; ，这个参数是HANDLE类型，通常是指针，在 64位程序中，就是8个字节，用dq命令来看。容易看到结果为空。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; dq @rsp+0x38
00000073`ac18c1a0 00000000`00000000 00000000`00000000
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="函数代码的观察"&gt;函数代码的观察
&lt;/h2&gt;&lt;p&gt;断点处，我们可以看到&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;KERNEL32!CreateFileW:
00007ff8`93b970f0 ff25ea270300 jmp qword ptr [KERNEL32!_imp_CreateFileW (00007ff8`93bc98e0)] ds:00007ff8`93bc98e0={KERNELBASE!CreateFileW (00007ff8`922f3ac0)}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个代表下一步要执行的指令。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;00007ff8`93b970f0&lt;/code&gt; : 当前指令的地址。&lt;/li&gt;
&lt;li&gt;指令 &lt;code&gt;ff25ea270300&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="指令的解读-ff25ea270300"&gt;指令的解读 &lt;code&gt;ff25ea270300&lt;/code&gt;
&lt;/h4&gt;&lt;p&gt;拆分为:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ff25&lt;/code&gt; : &lt;code&gt;jmp qword ptr [RIP+displacement]&lt;/code&gt; 这个操作码（OPCODE）。意思是，以当前 &lt;code&gt;RIP&lt;/code&gt; （当前指令地址） 作为基地址，叠加 displacement 偏移量后，得到的地址按照QWORD解析，并作为地址进一步跳转到其指向的位置。（因此涉及到一次跳转）
&lt;ul&gt;
&lt;li&gt;这个跳转通常叫做 IAT （操作系统和指令层都实现的概念：Import Address Table，导入地址表）&lt;/li&gt;
&lt;li&gt;IAT这个技术用来做动态链接。提供一个间接层，程序在自己的内存空间设置一张指针表。那么通过IAT跳转指令 &lt;code&gt;jmp qword ptr&lt;/code&gt; （间接跳转指令），就会进一步解码这个表中指向的地址，从而实现RIP的计算、解码加跳转。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ea270300&lt;/code&gt; ：4个byte，偏移量。因为是 Little Endian，所以代表的值为 &lt;code&gt;0x000327ea&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;计算间接跳转地址 &lt;code&gt;00007ff8`93b970f0&lt;/code&gt; + &lt;code&gt;0x000327ea&lt;/code&gt; = &lt;code&gt;00007ff8`93bc98e0&lt;/code&gt; 。这个地址是IAT表的地址。因此按照里面的值，进一步查找地址，得到 &lt;code&gt;00007ff8`922f3ac0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;显示区域的 &lt;code&gt;ds:00007ff8`93bc98e0={KERNELBASE!CreateFileW (00007ff8`922f3ac0)}&lt;/code&gt; 显示的是IAT表项的地址。不过并不代表使用了段寄存器，而是反汇编工具的约定，是一个注释，表明它访问的是数据内存（IAT表）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="真正的代码位置"&gt;真正的代码位置
&lt;/h4&gt;&lt;p&gt;经过上面的分析，我们知道，真正的要执行的代码的位置在 &lt;code&gt;00007ff8`922f3ac0&lt;/code&gt; ，其对应的符号表的符号为 &lt;code&gt;KERNELBASE!CreateFileW&lt;/code&gt;&lt;/p&gt;
&lt;h4 id="函数地址和符号"&gt;函数地址和符号
&lt;/h4&gt;&lt;p&gt;函数地址在调试的时候，经常有与之相关的符号：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; ln 00007ff8`922f3ac0
Browse module
Set bu breakpoint
(00007ff8`922f3ac0) KERNELBASE!CreateFileW | (00007ff8`922f3ba0) KERNELBASE!SleepEx
Exact matches:
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到地址对应的符号为 &lt;code&gt;KERNELBASE!CreateFileW&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;反之，也可以从符号找到对应的地址：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; ln KERNELBASE!CreateFileW
Browse module
Set bu breakpoint
(00007ff8`922f3ac0) KERNELBASE!CreateFileW | (00007ff8`922f3ba0) KERNELBASE!SleepEx
Exact matches:
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="符号和地址如何关联的呢"&gt;符号和地址如何关联的呢？
&lt;/h4&gt;&lt;p&gt;答案：通过调试信息文件。windows自己加载了对应的调试信息。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; lm m kernelbase
Browse full module list
start end module name
00007ff8`922b0000 00007ff8`926a8000 KERNELBASE (pdb symbols) C:\ProgramData\Dbg\sym\kernelbase.pdb\8314490F996705E2CF4A8DF59DF277DB1\kernelbase.pdb
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="如何知道我们自己程序的调试符号表有没有加载"&gt;&lt;strong&gt;如何知道我们自己程序的调试符号表有没有加载？&lt;/strong&gt;
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; lm m VulkanGLFWDemo
Browse full module list
start end module name
00007ff7`f70b0000 00007ff7`f70fa000 VulkanGLFWDemo C (no symbols)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到没有加载。这是由于我们用的时release无符号版本的程序。（当然，release也可以配置生成pdb调试信息）&lt;/p&gt;
&lt;h4 id="如何查看具体汇编代码指令方式"&gt;&lt;strong&gt;如何查看具体汇编代码&lt;/strong&gt;（指令方式）
&lt;/h4&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; u KERNELBASE!CreateFileW L10
KERNELBASE!CreateFileW:
00007ff8`922f3ac0 488bc4 mov rax,rsp
00007ff8`922f3ac3 48895808 mov qword ptr [rax+8],rbx
00007ff8`922f3ac7 48896810 mov qword ptr [rax+10h],rbp
00007ff8`922f3acb 48897018 mov qword ptr [rax+18h],rsi
00007ff8`922f3acf 48897820 mov qword ptr [rax+20h],rdi
00007ff8`922f3ad3 4156 push r14
00007ff8`922f3ad5 4883ec50 sub rsp,50h
00007ff8`922f3ad9 448bb42480000000 mov r14d,dword ptr [rsp+80h]
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;u&lt;/code&gt; ： unassemble，反汇编&lt;/li&gt;
&lt;li&gt;&lt;code&gt;L8&lt;/code&gt; : 8行 。注意 L后面跟的是16进制数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面来具体解释这里面的汇编干了什么&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;地址&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;机器码&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;汇编指令&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;解释&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;目的&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ac0}$&lt;/td&gt;
&lt;td&gt;$\text{488bc4}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov rax,rsp&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将当前的栈指针 $\text{RSP}$ 的值备份到 $\text{RAX}$。&lt;/td&gt;
&lt;td&gt;暂时保存栈指针，以便在 $\text{RSP}$ 被后续指令修改后，仍能通过 $\text{RAX}$ 访问原始栈帧（特别是阴影空间）。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ac3}$&lt;/td&gt;
&lt;td&gt;$\text{48895808}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov qword ptr [rax+8],rbx&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RBX}$ 寄存器的值保存到 $\text{RAX}+0\text{x}08$ 处。&lt;/td&gt;
&lt;td&gt;保存 &lt;strong&gt;非易失性&lt;/strong&gt; 寄存器 $\text{RBX}$。该地址是 $\text{RSP}+0\text{x}08$，即&lt;strong&gt;阴影空间&lt;/strong&gt;的第一个槽位。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ac7}$&lt;/td&gt;
&lt;td&gt;$\text{48896810}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov qword ptr [rax+10h],rbp&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RBP}$ 的值保存到 $\text{RAX}+0\text{x}10$ 处。&lt;/td&gt;
&lt;td&gt;保存 &lt;strong&gt;非易失性&lt;/strong&gt; 寄存器 $\text{RBP}$（基址指针）。这是阴影空间的第二个槽位。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3acb}$&lt;/td&gt;
&lt;td&gt;$\text{48897018}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov qword ptr [rax+18h],rsi&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RSI}$ 的值保存到 $\text{RAX}+0\text{x}18$ 处。&lt;/td&gt;
&lt;td&gt;保存 &lt;strong&gt;非易失性&lt;/strong&gt; 寄存器 $\text{RSI}$。这是阴影空间的第三个槽位。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3acf}$&lt;/td&gt;
&lt;td&gt;$\text{48897820}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov qword ptr [rax+20h],rdi&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RDI}$ 的值保存到 $\text{RAX}+0\text{x}20$ 处。&lt;/td&gt;
&lt;td&gt;保存 &lt;strong&gt;非易失性&lt;/strong&gt; 寄存器 $\text{RDI}$。这是阴影空间的第四个槽位。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ad3}$&lt;/td&gt;
&lt;td&gt;$\text{4156}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;push r14&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{R14}$ 寄存器的值压入栈中。&lt;/td&gt;
&lt;td&gt;保存 &lt;strong&gt;非易失性&lt;/strong&gt; 寄存器 $\text{R14}$。这会使 $\text{RSP}$ 减去 $0\text{x}08$。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ad5}$&lt;/td&gt;
&lt;td&gt;$\text{4883ec50}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;sub rsp,50h&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RSP}$ 减去 $0\text{x}50$ ($80$ 字节)。&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;分配局部变量和后续函数调用所需的栈帧空间。&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$\text{922f3ad9}$&lt;/td&gt;
&lt;td&gt;$\text{448bb42480000000}$&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;&lt;code&gt;mov r14d,dword ptr [rsp+80h]&lt;/code&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;将 $\text{RSP} + 0\text{x}80$ 处的 4 字节数据加载到 $\text{R14D}$（$\text{R14}$ 的低 32 位）。&lt;/td&gt;
&lt;td&gt;访问栈上参数或调用者栈帧中的局部变量。$0\text{x}80$ 是相对于&lt;strong&gt;调整后的 $\text{RSP}$&lt;/strong&gt; 的大偏移量。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;注：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;类似 &lt;code&gt;r14d&lt;/code&gt; ，还有 &lt;code&gt;eax, ebx, ecx&lt;/code&gt; 分别代表 &lt;code&gt;rax, rbx, rcx&lt;/code&gt; 的低32位&lt;/li&gt;
&lt;li&gt;更多代码内容，从汇编分析，就比较费时间和偏离主题了。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="如何查看具体汇编代码ui方式"&gt;&lt;strong&gt;如何查看具体汇编代码&lt;/strong&gt;（UI方式）
&lt;/h4&gt;&lt;p&gt;可以打开 Disaseembly 面板。（当然如果有源代码+pdb文件，甚至可以直接打开源代码，类似普通在 vscode 中调试一样）&lt;/p&gt;
&lt;p&gt;&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763521358979.png"
loading="lazy"
alt="WinDbg的初级用法-1763521358979"
&gt;&lt;/p&gt;
&lt;h1 id="ttd指令"&gt;TTD指令
&lt;/h1&gt;&lt;p&gt;time travel 模式下，有一些便捷指令。尤其常用 &lt;code&gt;!tt&lt;/code&gt; 和 &lt;code&gt;!tt &amp;lt;position&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; tt 0 - Time travel to the beginning of the trace (percentage)
tt 50 - Time travel to halfway through the trace (percentage)
tt 100 - Time travel to the end of the trace (percentage)
tt 13.56 - Time travel to 13.56% through the trace
tt 1A0: - Time travel to position 1A0:0
tt 1A0:0 - Time travel to position 1A0:0
tt 1A0:12F - Time travel to position 1A0:12F
tt 1A0000000000000012F - Time travel to position 1A0:12F
tt br rax - Time travel to the next write to RAX
tt br- rax 0x12345678 - Time travel to the previous write to RAX with the value 0x12345678
tt ba- rw 0x12345678 0x4000 - Find previous position that reads or writes from memory range
[0x12345678 - 0x12345678 + 0x4000).
tt ba e 0x7fffe0001234 0x30000 - Find next position that executes from specified range. If the
address and range represent the range of ntdll.dll, this command
would find the next position where ntdll.dll is entered.
tt bm - Time travel to the next instruction that is in a different module
than current instruction&amp;#39;s module.
tt bm- ntdll.dll - Time travel to the previous instruction that is in ntdll.dll
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;此外，在ttd模式下，还可以用 ：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;p-&lt;/code&gt; ： 回退一步&lt;/li&gt;
&lt;li&gt;&lt;code&gt;g-&lt;/code&gt; ： 回退到上一个缎带你&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="todo-未来有空再进一步研究"&gt;TODO: (未来有空再进一步研究)
&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;memory leak调试&lt;/li&gt;
&lt;li&gt;脚本：NatVis&lt;/li&gt;
&lt;li&gt;脚本：javascript&lt;/li&gt;
&lt;li&gt;以及更多学习资料： &lt;a class="link" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-resources" target="_blank" rel="noopener"
&gt;https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-resources&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>记录调试Vulkan程序打印奇怪日志的问题</title><link>https://crackhopper.github.io/2025/11/17/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98/</link><pubDate>Mon, 17 Nov 2025 21:52:05 +0800</pubDate><author>crackhopper@gmail.com (crackhopper)</author><guid>https://crackhopper.github.io/2025/11/17/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98/</guid><description>&lt;p&gt;为什么好好的vulkan程序会突然打印神秘的日志？是代码的扭曲，还是SDK的沦丧？且看我慢慢分解。&lt;/p&gt;
&lt;h2 id="起因"&gt;起因
&lt;/h2&gt;&lt;p&gt;最近开始学习 &lt;code&gt;Vulkan&lt;/code&gt; 图形接口，依照 &lt;a class="link" href="https://vulkan-tutorial.com/" target="_blank" rel="noopener"
&gt;https://vulkan-tutorial.com/&lt;/a&gt; 的教程配合ChatGpt, Gemni, DeepSeek，学起来速度飞起，不亦乐乎。最后，在用了2-3天的时候，成功画出了第一个三角形。&lt;/p&gt;
&lt;p&gt;随后，我发现程序有一个奇怪的地方：&lt;/p&gt;
&lt;img src="https://crackhopper.github.io/images/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95Vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98-1763387839953.png" alt="记录调试Vulkan程序打印奇怪日志的问题-1763387839953" width="700x416" loading="lazy" /&gt;
&lt;p&gt;这个文件的全名是： &lt;code&gt;VulkanGLFWDemo.20251117-xxxxxx-xxxx.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;我的代码基本上就是照着tutorial复刻的，有改动，但都是在自己理解的情况下做的一些简单改动。绝对没有日志打印的操作。&lt;/p&gt;
&lt;p&gt;怀着好奇心，我打开这个文件，想看看到底是啥日志。夸张的事情来了：
&lt;img src="https://crackhopper.github.io/images/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95Vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98-1763387971733.png"
loading="lazy"
alt="记录调试Vulkan程序打印奇怪日志的问题-1763387971733"
&gt;&lt;/p&gt;
&lt;p&gt;虽然后缀是 &lt;code&gt;.log&lt;/code&gt; 但是是个二进制文件！但二进制文件咱就看不了了么？显然不是，用hex editor插件打开。我要看看二进制中是不是有什么字符串，能让我猜出来到底咋回事。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://crackhopper.github.io/images/%E8%AE%B0%E5%BD%95%E8%B0%83%E8%AF%95Vulkan%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8D%B0%E5%A5%87%E6%80%AA%E6%97%A5%E5%BF%97%E7%9A%84%E9%97%AE%E9%A2%98-1763388065279.png"
loading="lazy"
alt="记录调试Vulkan程序打印奇怪日志的问题-1763388065279"
&gt;&lt;/p&gt;
&lt;p&gt;WTF？！&lt;/p&gt;
&lt;h2 id="经过"&gt;经过
&lt;/h2&gt;&lt;p&gt;鉴于自己新学Vulkan，可能不够熟练，也许是某个编译配置的开关，或者vulkan的一些底层机制我没学到，会有一些默认的打印操作。于是我虚心请教了AI的看法……&lt;/p&gt;
&lt;p&gt;随后，经历了跟AI的各种狂猜乱试，我发现，完全是“两个臭皮匠”在讨论。&lt;/p&gt;
&lt;p&gt;AI可以不停的给我提出各种各样没用的方案。&lt;/p&gt;
&lt;p&gt;看来定位不到核心的原因，我是没办法解决这个问题了。&lt;/p&gt;
&lt;p&gt;考虑到，程序无非就是二进制在CPU上跑，我直接动态调试二进制程序不就可以了？于是开启了我的WinDbg之路。&lt;/p&gt;
&lt;h2 id="windbg"&gt;WinDbg
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;关于 WinDbg 的使用，更多参见&lt;/strong&gt; &lt;a class="link" href="https://crackhopper.github.io/2025/11/17/windbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95/" &gt;WinDbg的初级用法&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="问题定位"&gt;问题定位
&lt;/h1&gt;&lt;h2 id="增加断点处的行为scripting"&gt;增加断点处的行为(scripting)
&lt;/h2&gt;&lt;p&gt;首先，我们在创建文件的位置，增加一些脚本，打印一下文件名。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;bp KERNELBASE!CreateFileA &amp;#34;r rcx; da @rcx; k L3; g&amp;#34;
bp KERNELBASE!CreateFileW &amp;#34;r rcx; du @rcx; k L3; g&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;r rcx&lt;/code&gt; ： 打印 rcx的值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;du rcx&lt;/code&gt; ：以unicode编码解析rcx指向的地址&lt;/li&gt;
&lt;li&gt;&lt;code&gt;k L3&lt;/code&gt; : 打印3行堆栈&lt;/li&gt;
&lt;li&gt;&lt;code&gt;g&lt;/code&gt; ： 不停止，继续执行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;接着让我们运行看下会发生什么，将我们的断点配置如下：
&lt;img src="https://crackhopper.github.io/images/WinDbg%E7%9A%84%E5%88%9D%E7%BA%A7%E7%94%A8%E6%B3%95-1763438550768.png"
loading="lazy"
alt="WinDbg的初级用法-1763438550768"
&gt;&lt;/p&gt;
&lt;p&gt;输出很长。可以见有很多文件都被打开。（大大出乎预料）&lt;/p&gt;
&lt;p&gt;下面一段是摘抄的部分日志：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;rcx=00000073ac18c200
00000073`ac18c200 &amp;#34;C:\ProgramData\obs-studio-hook\o&amp;#34;
00000073`ac18c240 &amp;#34;bs-vulkan64.json&amp;#34;
# Child-SP RetAddr Call Site
00 00000073`ac18c1b8 00007fff`8b77f6dc KERNEL32!CreateFileW
01 00000073`ac18c1c0 00007fff`8b77f277 vulkan_1!vkResetEvent+0x4e14c
02 00000073`ac18c2e0 00007fff`8b776595 vulkan_1!vkResetEvent+0x4dce7
rcx=00000073ac18c1d0
00000073`ac18c1d0 &amp;#34;C:\Program Files (x86)\WeGame\ap&amp;#34;
00000073`ac18c210 &amp;#34;ps\Cross\Core\Stable\CrossVulkan&amp;#34;
00000073`ac18c250 &amp;#34;Layer64.json&amp;#34;
# Child-SP RetAddr Call Site
00 00000073`ac18c188 00007fff`8b77f6dc KERNEL32!CreateFileW
01 00000073`ac18c190 00007fff`8b77f277 vulkan_1!vkResetEvent+0x4e14c
02 00000073`ac18c2e0 00007fff`8b776595 vulkan_1!vkResetEvent+0x4dce7
rcx=00000073ac18c1f0
00000073`ac18c1f0 &amp;#34;C:\Program Files (x86)\Steam\Ste&amp;#34;
00000073`ac18c230 &amp;#34;amOverlayVulkanLayer64.json&amp;#34;
# Child-SP RetAddr Call Site
00 00000073`ac18c1a8 00007fff`8b77f6dc KERNEL32!CreateFileW
01 00000073`ac18c1b0 00007fff`8b77f277 vulkan_1!vkResetEvent+0x4e14c
02 00000073`ac18c2e0 00007fff`8b776595 vulkan_1!vkResetEvent+0x4dce7
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="日志分析"&gt;日志分析
&lt;/h2&gt;&lt;p&gt;由于文件很长，因此我用AI编写了脚本专门处理上面的日志文件，提取对应的调用函数，以及打开的文件。（特意跳过stack中，系统相关的函数）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 1
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 2
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 3
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 4
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 5
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 6
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 7
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 8
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 9
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 10
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 11
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 12
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 13
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 14
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 15
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 16
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 17
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 18
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 19
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 20
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 21
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 22
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 23
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 24
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 25
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 26
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 27
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 28
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 29
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 30
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 31
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 32
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 33
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 34
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 35
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 36
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 37
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 38
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 39
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 40
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 41
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 42
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 43
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 44
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 45
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 46
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 47
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 48
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 49
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 50
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 51
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 52
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 53
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 54
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 55
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 56
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 57
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 58
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 59
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 60
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 61
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 62
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 63
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 64
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 65
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 66
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 67
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 68
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 69
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 70
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 71
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 72
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 73
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 74
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 75
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 76
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 77
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 78
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 79
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 80
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 81
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 82
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 83
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 84
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 85
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 86
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 87
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 88
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 89
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 90
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 91
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 92
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 93
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 94
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 95
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 96
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 97
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 98
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 99
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;100
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;101
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;102
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;103
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;104
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;105
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;106
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;107
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;108
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;109
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;110
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;111
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;112
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;113
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;114
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;115
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;116
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;117
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;118
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;119
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;120
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;121
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;122
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;123
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;124
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;125
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;126
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;127
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;128
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;129
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;130
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;131
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;132
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;133
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;134
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;135
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;136
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;137
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;138
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;139
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;140
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;141
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;142
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;143
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;144
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;145
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;146
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;147
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;148
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;149
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;150
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;151
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;152
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;153
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;154
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;155
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;156
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;157
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;158
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;159
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;160
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;161
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;162
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;163
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;164
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;165
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;166
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;167
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;168
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;169
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;170
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;171
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;172
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;173
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;174
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;175
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;176
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;177
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;178
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;179
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;180
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;181
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;182
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;183
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;184
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;185
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;186
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;187
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;188
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;189
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;190
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;191
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;192
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;193
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;194
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;195
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;196
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;197
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;198
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;199
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;200
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;201
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;202
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;203
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;204
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;205
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;206
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;在 windbg 调试程序的时候。用如下方法设置断点：
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;bp KERNELBASE!CreateFileA &amp;#34;r rcx; da @rcx; k L3; g&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;bp KERNELBASE!CreateFileW &amp;#34;r rcx; du @rcx; k L3; g&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;会在中断的地方打印第一个参数。（这里是文件名字）。本脚本则是为了处理输出的日志，提取对应有效信息。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;import&lt;/span&gt; &lt;span style="color:#24292e"&gt;re&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;import&lt;/span&gt; &lt;span style="color:#24292e"&gt;argparse&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;import&lt;/span&gt; &lt;span style="color:#24292e"&gt;sys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;import&lt;/span&gt; &lt;span style="color:#24292e"&gt;os&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;# 定义系统调用函数的前缀（使用更标准的常量命名）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;SYSTEM_CALLS_PREFIX &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;KERNEL32!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;ntdll!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;ntoskrnl!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;win32u!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;WOW64!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;WOW64T!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;WOW64CPU!&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;split_blocks&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_text&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 根据 &amp;#39;rcx=&amp;#39; 分隔符将日志文本拆分成独立的块。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 使用 re.split，并保留分隔符&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; blocks &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; re&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;split&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;r&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;(rcx=.*)&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; log_text&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 清理和组合：将分隔符与其后的内容组合成一个块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; processed_blocks &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; i &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; &lt;span style="color:#6639ba"&gt;range&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#6639ba"&gt;len&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;blocks&lt;span style="color:#1f2328"&gt;),&lt;/span&gt; &lt;span style="color:#0550ae"&gt;2&lt;/span&gt;&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; i &lt;span style="color:#0550ae"&gt;+&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1&lt;/span&gt; &lt;span style="color:#0550ae"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#6639ba"&gt;len&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;blocks&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; processed_blocks&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;blocks&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;i&lt;span style="color:#1f2328"&gt;]&lt;/span&gt; &lt;span style="color:#0550ae"&gt;+&lt;/span&gt; blocks&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;i &lt;span style="color:#0550ae"&gt;+&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[&lt;/span&gt;block&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;strip&lt;span style="color:#1f2328"&gt;()&lt;/span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; block &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; processed_blocks &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; block&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;strip&lt;span style="color:#1f2328"&gt;()]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;extract_string_from_block&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 从一个日志块中提取并拼接双引号内的字符串，形成完整的路径。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 正则表达式匹配行首的地址 (例如 0000022a`1b31a090) 后面的双引号内容&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; path_pattern &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; re&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;compile&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;r&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;^\s*[\da-fA-F]+`[\da-fA-F]+\s+&amp;#34;(.*?)&amp;#34;$&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; re&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;MULTILINE&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 查找所有匹配项&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; path_segments &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; path_pattern&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;findall&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 拼接所有段落&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; string_value &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;join&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;path_segments&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; string_value
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;extract_rcx_id&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 从一个日志块的开头提取 rcx=... 的值作为块的标识。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 正则表达式匹配 &amp;#39;rcx=&amp;#39; 后跟至少一个或多个十六进制字符&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; rcx_pattern &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; re&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;compile&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;r&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;(rcx=[\da-fA-F]+)&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; re&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;IGNORECASE&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; rcx_match &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; rcx_pattern&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;search&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; rcx_match&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; rcx_match&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;group&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;else&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;N/A&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;extract_callsite_info&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 从一个日志块中提取 Call Site 信息，并找到第一个非系统调用函数。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# Call Site 区域通常以 &amp;#39;# Child-SP&amp;#39; 开始&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; callstack_start_marker &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;# Child-SP&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; callstack_start_marker &lt;span style="color:#0550ae"&gt;not&lt;/span&gt; &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; block&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;Call Site region not found.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 找到 Call Site 区域的起始位置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; start_index &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; block&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;find&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;callstack_start_marker&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; callstack_section &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; block&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;start_index&lt;span style="color:#1f2328"&gt;:]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 按行分割&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; lines &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; callstack_section&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;split&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#0a3069"&gt;\n&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 提取 Call Site&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; call_sites &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 跳过标题行和可能为空的行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; line &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; lines&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; line &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; line&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;strip&lt;span style="color:#1f2328"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#0550ae"&gt;not&lt;/span&gt; line &lt;span style="color:#0550ae"&gt;or&lt;/span&gt; line&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;startswith&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 假设 Call Site 是每行最后一个非空的字段（通常是模块!函数名+偏移量）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parts &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; line&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;split&lt;span style="color:#1f2328"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#6639ba"&gt;len&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;parts&lt;span style="color:#1f2328"&gt;)&lt;/span&gt; &lt;span style="color:#0550ae"&gt;&amp;gt;=&lt;/span&gt; &lt;span style="color:#0550ae"&gt;4&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; call_site &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; parts&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;&lt;span style="color:#0550ae"&gt;-&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; call_sites&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;call_site&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 查找第一个非系统调用函数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; site &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; call_sites&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; is_system_call &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#cf222e"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 排除地址/偏移量部分，只保留函数名（如 igxelpicd64!DumpRegistryKeyDefinitions）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;!&amp;#39;&lt;/span&gt; &lt;span style="color:#0550ae"&gt;not&lt;/span&gt; &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; site&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;continue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; sys_call &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; SYSTEM_CALLS_PREFIX&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; site&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;startswith&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;sys_call&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; is_system_call &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#cf222e"&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#0550ae"&gt;not&lt;/span&gt; is_system_call&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; site
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;Only system calls or no calls found.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;parse_log&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_text&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 主解析函数，协调所有子函数。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; blocks &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; split_blocks&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_text&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; results &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; block &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; blocks&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; rcx_value &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; extract_rcx_id&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; string_value &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; extract_string_from_block&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; first_non_sys_call &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; extract_callsite_info&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;block&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 检查是否提取到有效的字符串和 Call Site&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; string_value &lt;span style="color:#0550ae"&gt;and&lt;/span&gt; first_non_sys_call &lt;span style="color:#0550ae"&gt;!=&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;Only system calls or no calls found.&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; results&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;rcx_value&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt; rcx_value&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;string_value&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt; string_value&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;first_non_system_call&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt; first_non_sys_call
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#1f2328"&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;return&lt;/span&gt; results
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#57606a"&gt;# --- 新增命令行参数和主函数 ---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;def&lt;/span&gt; &lt;span style="color:#6639ba"&gt;main&lt;/span&gt;&lt;span style="color:#1f2328"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; 程序入口点，处理命令行参数和文件读取。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#0a3069"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parser &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; argparse&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;ArgumentParser&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; description&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;解析 WinDbg 日志文件，提取文件路径和第一个非系统调用 Call Site。&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 定义必须传入的日志文件参数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parser&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;add_argument&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;log_file&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;type&lt;/span&gt;&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#6639ba"&gt;str&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; help&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;要解析的 WinDbg 日志文件路径。&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 定义可选的输出文件参数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parser&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;add_argument&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;-o&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;--output&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;type&lt;/span&gt;&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#6639ba"&gt;str&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; help&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;将解析结果写入指定文件（例如 result.txt）。如果未指定，则打印到控制台。&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; args &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; parser&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;parse_args&lt;span style="color:#1f2328"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; log_file_path &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; args&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;log_file
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_file_path &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; args&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;output
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#0550ae"&gt;not&lt;/span&gt; os&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;path&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;exists&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_file_path&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;print&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;错误：文件未找到 -&amp;gt; &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;log_file_path&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; file&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;stderr&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;exit&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;try&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 读取日志文件内容，使用 &amp;#39;utf-8&amp;#39; 或 &amp;#39;latin-1&amp;#39; 应对可能的编码问题&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;with&lt;/span&gt; &lt;span style="color:#6639ba"&gt;open&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_file_path&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; encoding&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; errors&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt; &lt;span style="color:#cf222e"&gt;as&lt;/span&gt; f&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; log_content &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; f&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;read&lt;span style="color:#1f2328"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;except&lt;/span&gt; Exception &lt;span style="color:#cf222e"&gt;as&lt;/span&gt; e&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;print&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;读取文件时发生错误: &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;e&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; file&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;stderr&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;exit&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 执行解析&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parsed_results &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; parse_log&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;log_content&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 格式化输出结果&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#1f2328"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;for&lt;/span&gt; i&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; result &lt;span style="color:#0550ae"&gt;in&lt;/span&gt; &lt;span style="color:#6639ba"&gt;enumerate&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;parsed_results&lt;span style="color:#1f2328"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;-&amp;#34;&lt;/span&gt; &lt;span style="color:#0550ae"&gt;*&lt;/span&gt; &lt;span style="color:#0550ae"&gt;50&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;记录 &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;i &lt;span style="color:#0550ae"&gt;+&lt;/span&gt; &lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt; (&lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;result&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;rcx_value&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;]&lt;/span&gt;&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;)&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34; 文件路径/字符串: &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;result&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;string_value&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;]&lt;/span&gt;&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34; 调用点: &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;result&lt;span style="color:#1f2328"&gt;[&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;first_non_system_call&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;]&lt;/span&gt;&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_lines&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;append&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;-&amp;#34;&lt;/span&gt; &lt;span style="color:#0550ae"&gt;*&lt;/span&gt; &lt;span style="color:#0550ae"&gt;50&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_text &lt;span style="color:#0550ae"&gt;=&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#0a3069"&gt;\n&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;join&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;output_lines&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 处理输出&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;if&lt;/span&gt; output_file_path&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;try&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;with&lt;/span&gt; &lt;span style="color:#6639ba"&gt;open&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;output_file_path&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; encoding&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt; &lt;span style="color:#cf222e"&gt;as&lt;/span&gt; f&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; f&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;write&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;output_text&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;print&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;解析结果已成功写入文件: &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;output_file_path&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;except&lt;/span&gt; Exception &lt;span style="color:#cf222e"&gt;as&lt;/span&gt; e&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;print&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0a3069"&gt;f&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;写入文件时发生错误: &lt;/span&gt;&lt;span style="color:#0a3069"&gt;{&lt;/span&gt;e&lt;span style="color:#0a3069"&gt;}&lt;/span&gt;&lt;span style="color:#0a3069"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;,&lt;/span&gt; file&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;stderr&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sys&lt;span style="color:#0550ae"&gt;.&lt;/span&gt;exit&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;&lt;span style="color:#0550ae"&gt;1&lt;/span&gt;&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#cf222e"&gt;else&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#57606a"&gt;# 打印到控制台&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6639ba"&gt;print&lt;/span&gt;&lt;span style="color:#1f2328"&gt;(&lt;/span&gt;output_text&lt;span style="color:#1f2328"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cf222e"&gt;if&lt;/span&gt; &lt;span style="color:#953800"&gt;__name__&lt;/span&gt; &lt;span style="color:#0550ae"&gt;==&lt;/span&gt; &lt;span style="color:#0a3069"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span style="color:#1f2328"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; main&lt;span style="color:#1f2328"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;处理结果（部分摘要）：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;--------------------------------------------------
记录 1 (rcx=00000073ac18c200)
文件路径/字符串: C:\ProgramData\obs-studio-hook\obs-vulkan64.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
记录 2 (rcx=00000073ac18c1d0)
文件路径/字符串: C:\Program Files (x86)\WeGame\apps\Cross\Core\Stable\CrossVulkanLayer64.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
记录 3 (rcx=00000073ac18c1f0)
文件路径/字符串: C:\Program Files (x86)\Steam\SteamOverlayVulkanLayer64.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
记录 4 (rcx=00000073ac18c1f0)
文件路径/字符串: C:\Program Files (x86)\Steam\SteamFossilizeVulkanLayer64.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
记录 5 (rcx=00000073ac18c1b0)
文件路径/字符串: C:\Program Files (x86)\Epic Games\Launcher\Portal\Extras\Overlay\EOSOverlayVkLayer-Win32.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
记录 6 (rcx=00000073ac18c1b0)
文件路径/字符串: C:\Program Files (x86)\Epic Games\Launcher\Portal\Extras\Overlay\EOSOverlayVkLayer-Win64.json
调用点: vulkan_1!vkResetEvent+0x4e14c
--------------------------------------------------
...
--------------------------------------------------
记录 1025 (rcx=0000022a1b31a090)
文件路径/字符串: C:\Users\develop\AppData\LocalLow\Intel\ShaderCache\fef977ca3300ec0bc2c0cffc3b7876ee20569af48fb97cdc1b368bbc0e5a57f6
调用点: igxelpicd64!DumpRegistryKeyDefinitions+0xb43aa
--------------------------------------------------
记录 1026 (rcx=0000022a1b31a090)
文件路径/字符串: C:\Users\develop\AppData\LocalLow\Intel\ShaderCache\ff99df07dcd0c6178ee47752e83177aee8f50f71c5e1bf8eaf748c39909b3bb1
调用点: igxelpicd64!DumpRegistryKeyDefinitions+0xb43aa
--------------------------------------------------
记录 1027 (rcx=0000022a1b31a090)
文件路径/字符串: C:\Users\develop\AppData\LocalLow\Intel\ShaderCache\ffbf928ad5120a2f1efed1a992d0e667884951d6f937bdb98f037eae46cde6e1
调用点: igxelpicd64!DumpRegistryKeyDefinitions+0xb43aa
--------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="日志问题"&gt;日志问题
&lt;/h2&gt;&lt;p&gt;首先，居然打开了1027个文件！！大部分都是由 igxelpicd64 和 igvk64 打开的。这两个是什么？&lt;/p&gt;
&lt;h2 id="原因定位"&gt;原因定位
&lt;/h2&gt;&lt;h3 id="1-本地打开日志文件"&gt;1. 本地打开日志文件
&lt;/h3&gt;&lt;p&gt;通过日志，我们可以搜索，找到：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;rcx=0000022a16429dc0
0000022a`16429dc0 &amp;#34;C:/Program Files (x86)/WeGame/ap&amp;#34;
0000022a`16429e00 &amp;#34;ps/Cross/Core/Stable/../../Log/V&amp;#34;
0000022a`16429e40 &amp;#34;ulkanGLFWDemo.20251118-120259-84&amp;#34;
0000022a`16429e80 &amp;#34;2.log&amp;#34;
# Child-SP RetAddr Call Site
00 00000073`ac189e88 00007ff8`499ba227 KERNEL32!CreateFileW
01 00000073`ac189e90 00007ff8`499b9729 CrossVulkanLayer64!base::BaseTimer::Stop+0xc5297
02 00000073`ac189f80 00007ff8`499ba53d CrossVulkanLayer64!base::BaseTimer::Stop+0xc4799
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;显然，有个奇怪的模块调用。&lt;/p&gt;
&lt;p&gt;可以看到 &lt;code&gt;CrossVulkanLayer64&lt;/code&gt; 这个模块是罪魁祸首，我们看看到底这个模块啥来头&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0:000&amp;gt; lmv m CrossVulkanLayer64
Browse full module list
start end module name
00007fff`8bb10000 00007fff`8bcdf000 CrossVulkanLayer64 (export symbols) CrossVulkanLayer64.dll
Loaded symbol image file: CrossVulkanLayer64.dll
Mapped memory image file: C:\Program Files (x86)\WeGame\apps\Cross\Core\Stable\CrossVulkanLayer64.dll
Image path: C:\Program Files (x86)\WeGame\apps\Cross\Core\Stable\CrossVulkanLayer64.dll
Image name: CrossVulkanLayer64.dll
Browse all global symbols functions data Symbol Reload
Timestamp: Tue Sep 10 20:00:11 2024 (66E034CB)
CheckSum: 001D4A34
ImageSize: 001CF000
Mapping Form: Loaded
File version: 1.0.0.0
Product version: 1.0.0.0
File flags: 0 (Mask 17)
File OS: 4 Unknown Win32
File type: 2.0 Dll
File date: 00000000.00000000
Translations: 0804.04b0
Information from resource tables:
CompanyName: Tencent
ProductName: Tencent.WeGame.Cross
InternalName: VulkanLayer
ProductVersion: 1.0.0.0
FileVersion: 1.0.0.0
FileDescription: Tencent.WeGame.Cross.VulkanLayer
LegalCopyright: Copyright (C) 2017 Tencent.All Rights Reserved
LegalTrademarks: Tencent
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;原来是你！腾讯，WeGame！&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="2-igvk64被疯狂调用和操作未解决"&gt;2. igvk64被疯狂调用和操作（未解决）
&lt;/h3&gt;&lt;p&gt;在我们通过 &lt;code&gt;CreateFileW&lt;/code&gt; 断点，打印所有打开文件的操作的时候。日志里产生了大量 igvk64 和 igxeplicd 的调用。到底是怎么回事？&lt;/p&gt;
&lt;p&gt;在出问题的时候，手动中断，获取到堆栈信息：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[0x0] KERNEL32!CreateFileW 0x55168e3588 0x7fff7f6e783a
[0x1] igvk64!ctlTemperatureGetState+0x751fba 0x55168e3590 0x7fff7f6e67e9
[0x2] igvk64!ctlTemperatureGetState+0x750f69 0x55168e3760 0x7fff7f6d17f9
[0x3] igvk64!ctlTemperatureGetState+0x73bf79 0x55168e3800 0x7fff7f6cecfb
[0x4] igvk64!ctlTemperatureGetState+0x73947b 0x55168e39a0 0x7fff7f6ce00b
[0x5] igvk64!ctlTemperatureGetState+0x73878b 0x55168e39e0 0x7fff7f6c4276
[0x6] igvk64!ctlTemperatureGetState+0x72e9f6 0x55168e3a30 0x7fff7ee7040f
[0x7] igvk64!DumpRegistryKeyDefinitions+0x1c605f 0x55168e3ba0 0x7fff7ee607fb
[0x8] igvk64!DumpRegistryKeyDefinitions+0x1b644b 0x55168e41a0 0x7fff7ee476a4
[0x9] igvk64!DumpRegistryKeyDefinitions+0x19d2f4 0x55168e4310 0x7fff7ee31bd5
[0xa] igvk64!DumpRegistryKeyDefinitions+0x187825 0x55168e43c0 0x7fff7eda31e6
[0xb] igvk64!DumpRegistryKeyDefinitions+0xf8e36 0x55168e4410 0x7fff7ed87534
[0xc] igvk64!DumpRegistryKeyDefinitions+0xdd184 0x55168fb620 0x7fff7ed5ec7d
[0xd] igvk64!DumpRegistryKeyDefinitions+0xb48cd 0x55168fb690 0x7fff7ece0ca5
[0xe] igvk64!DumpRegistryKeyDefinitions+0x368f5 0x55168fb6e0 0x7fffbd89c6dc
[0xf] vulkan_1!vkResetEvent+0x4b14c 0x55168fb7b0 0x7fff810205e7
[0x10] VkLayer_khronos_validation!vulkan_layer_chassis::CreateInstance+0x217
[0x11] CrossVulkanLayer64!vkCreateInstance+0x180 0x55168fbad0 0x7ff8498fcacb
[0x12] graphics_hook64!dummy_debug_proc+0x294b 0x55168fbbe0 0x7fff741fc952
[0x13] nvoglv64!DrvPresentBuffers+0x3698d2 0x55168fbca0 0x7fffbd883652
[0x14] vulkan_1!vkResetEvent+0x320c2 0x55168fbcd0 0x7fffbd8a751e
[0x15] vulkan_1!vkResetEvent+0x55f8e 0x55168fc000 0x7ff717220f44
[0x16] VulkanGLFWDemo!HelloTriangleApplication::createInstance+0x244 0x55168ff410 0x7ff717224b64
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;关于 igxeplicd 产生的大量文件创建。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; # Child-SP RetAddr Call Site
00 00000055`168fd778 00007fff`f46ce16a KERNEL32!CreateFileW
01 00000055`168fd780 00007fff`f46cb720 igxelpicd64!DumpRegistryKeyDefinitions+0xb43aa
02 00000055`168fdb70 00007fff`f46c8cfb igxelpicd64!DumpRegistryKeyDefinitions+0xb1960
03 00000055`168fdd10 00007fff`f46c800b igxelpicd64!DumpRegistryKeyDefinitions+0xaef3b
04 00000055`168fdd50 00007fff`f46bbe16 igxelpicd64!DumpRegistryKeyDefinitions+0xae24b
05 00000055`168fdda0 00007fff`f457ce7c igxelpicd64!DumpRegistryKeyDefinitions+0xa2056
06 00000055`168fdf10 00007fff`f457b59e igxelpicd64!DrvValidateVersion+0x13c57c
07 00000055`168fe4e0 00007fff`f456e572 igxelpicd64!DrvValidateVersion+0x13ac9e
08 00000055`168fe520 00007fff`f443f6aa igxelpicd64!DrvValidateVersion+0x12dc72
09 00000055`168fe560 00007fff`f53bacfe igxelpicd64!DrvDescribePixelFormat+0x3a
0a 00000055`168fe5b0 00007fff`f53fd7e9 OpenGL32!_DescribeDriverPixelFormat+0x5a
0b 00000055`168fe5f0 00007fff`f5396e9f OpenGL32!LoadAvailableDrivers+0x3d9
0c 00000055`168fec50 00007fff`7422005c OpenGL32!wglDescribePixelFormat+0xdf
0d 00000055`168fed90 00007fff`74223622 nvoglv64!vk_optimusGetInstanceProcAddr+0x230ec
0e 00000055`168fedc0 00007fff`7421cfd7 nvoglv64!vk_optimusGetInstanceProcAddr+0x266b2
0f 00000055`168fee10 00007fff`bd8ad9cc nvoglv64!vk_optimusGetInstanceProcAddr+0x20067
10 00000055`168fee40 00007fff`812b4934 vulkan_1!vkResetEvent+0x5c43c
11 (Inline Function) --------`-------- VkLayer_khronos_validation!vvl::dispatch::Device::CreateSwapchainKHR+0xc1 [C:\SDKBuild\build-X64-1.4.328.1\Vulkan-ValidationLayers\layers\vulkan\generated\dispatch_object.cpp @ 3153]
12 00000055`168fef30 00007fff`8bb1af8a VkLayer_khronos_validation!vulkan_layer_chassis::CreateSwapchainKHR+0x2c4 [C:\SDKBuild\build-X64-1.4.328.1\Vulkan-ValidationLayers\layers\vulkan\generated\chassis.cpp @ 10385]
13 00000055`168ff140 00007ff8`498fdda0 CrossVulkanLayer64!vkCreateSwapchainKHR+0x182
14 00000055`168ff270 00007fff`bd8af465 graphics_hook64!dummy_debug_proc+0x3c20
15 00000055`168ff340 00007ff7`17221c0d vulkan_1!vkResetEvent+0x5ded5
16 00000055`168ff380 00007ff7`17224b96 VulkanGLFWDemo!HelloTriangleApplication::createSwapChain+0x27d [C:\Users\develop\game-dev\renderer\src\main.cpp @ 985]
17 00000055`168ff5d0 00007ff7`172286de VulkanGLFWDemo!HelloTriangleApplication::initVulkan+0x46 [C:\Users\develop\game-dev\renderer\src\main.cpp @ 800]
18 00000055`168ff600 00007ff7`171f878f VulkanGLFWDemo!HelloTriangleApplication::run+0x1e [C:\Users\develop\game-dev\renderer\src\main.cpp @ 63]
19 00000055`168ff630 00007ff7`17256919 VulkanGLFWDemo!main+0x2f [C:\Users\develop\game-dev\renderer\src\main.cpp @ 1431]
1a 00000055`168ff8a0 00007ff7`172567c2 VulkanGLFWDemo!invoke_main+0x39 [D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl @ 79]
1b 00000055`168ff8f0 00007ff7`1725667e VulkanGLFWDemo!__scrt_common_main_seh+0x132 [D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl @ 288]
1c 00000055`168ff960 00007ff7`172569ae VulkanGLFWDemo!__scrt_common_main+0xe [D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl @ 331]
1d 00000055`168ff990 00007ff8`93b6e8d7 VulkanGLFWDemo!mainCRTStartup+0xe [D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_main.cpp @ 17]
1e 00000055`168ff9c0 00007ff8`94fac53c KERNEL32!BaseThreadInitThunk+0x17
1f 00000055`168ff9f0 00000000`00000000 ntdll!RtlUserThreadStart+0x2c
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;实际上，虽然可以看到validation layer的影子。但无法确定是由其导致的。( &lt;strong&gt;因为validation layer有可能仅仅是转发一下调用&lt;/strong&gt; )&lt;/p&gt;
&lt;h2 id="为什么会这样vulkan为什么加载其他的dll"&gt;为什么会这样？Vulkan为什么加载其他的dll？
&lt;/h2&gt;&lt;p&gt;在 &lt;strong&gt;Vulkan 的设计机制中&lt;/strong&gt;，&lt;code&gt;vkCreateInstance&lt;/code&gt; 会根据调用时指定的 &lt;strong&gt;Layer 列表&lt;/strong&gt; 去加载对应 Layer（包括第三方 Validation Layer）的动态库（Windows 下为 &lt;code&gt;.dll&lt;/code&gt;，Linux 下为 &lt;code&gt;.so&lt;/code&gt;）。&lt;br&gt;
这是 Vulkan &lt;strong&gt;Layer 机制&lt;/strong&gt;的正常行为，而不是驱动“偷偷加载”。&lt;/p&gt;
&lt;h3 id="原因"&gt;原因
&lt;/h3&gt;&lt;p&gt;vulkan初始化的时候，会检查注册表，加载所有 &lt;code&gt;Implicit Layer&lt;/code&gt; 的配置（manifest）。这样同样也会加载对应的dll。这就是为什么 WeGame 的Layer被加载了。（vulkan的这个功能似乎很有安全问题啊！）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关于validation layer发现机制，更多参见&lt;/strong&gt;： &lt;a class="link" href="https://crackhopper.github.io/2025/11/19/vulkan%E7%9A%84layer%E5%8F%91%E7%8E%B0%E6%9C%BA%E5%88%B6/" &gt;Vulkan的Layer发现机制和debug&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="神秘日志问题解决"&gt;神秘日志问题解决！
&lt;/h1&gt;&lt;h2 id="方法一"&gt;方法一
&lt;/h2&gt;&lt;p&gt;仅把我使用的layer，对应的json和dll，存放到项目目录中。用 &lt;code&gt;VK_LAYER_PATH&lt;/code&gt; 指定程序仅加载我指定的layer。&lt;/p&gt;
&lt;p&gt;（暂时方法二更容易，采用方法二）&lt;/p&gt;
&lt;h2 id="方法二"&gt;方法二
&lt;/h2&gt;&lt;p&gt;设定环境变量：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#953800"&gt;VK_LOADER_LAYERS_DISABLE&lt;/span&gt;&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;~implicit~
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#953800"&gt;VK_LOADER_LAYERS_DISABLE&lt;/span&gt;&lt;span style="color:#0550ae"&gt;=&lt;/span&gt;*wegame*
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id="遗留问题未解决intel驱动总被调用"&gt;遗留问题未解决！intel驱动总被调用
&lt;/h1&gt;&lt;p&gt;由于内容比较多，单独开了一个帖子来记录。这个问题当前没找到解决方案。&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://crackhopper.github.io/2025/11/21/vulkan%E7%A8%8B%E5%BA%8F%E4%B8%ADintel%E9%A9%B1%E5%8A%A8%E6%80%BB%E6%98%AF%E8%A2%AB%E8%B0%83%E7%94%A8%E6%9C%AA%E8%A7%A3%E5%86%B3/" &gt;Vulkan程序中Intel驱动总是被调用（未解决）&lt;/a&gt;&lt;/p&gt;</description></item></channel></rss>